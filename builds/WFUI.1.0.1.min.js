function WFUICallback(t,e){return function(){return e.apply(t,arguments)}}var Class=function(){};!function(){var t=!1,e=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){},ClassWFUI.extend=function(i){function n(){!t&&this.init&&this.init.apply(this,arguments)}var s=this.prototype;t=!0;var a=new this;t=!1;for(var o in i)a[o]="function"==typeof i[o]&&"function"==typeof s[o]&&e.test(i[o])?function(t,e){return function(){var i=this._super;this._super=s[t];var n=e.apply(this,arguments);return this._super=i,n}}(o,i[o]):i[o];return n.prototype=a,n.prototype.constructor=n,n.extend=arguments.callee,n}}();var Callback=WFUICallback,vec2=function(){vec2.create=function(){return[0,0]},vec2.clone=function(t){var e=new Array(2);return e[0]=t[0],e[1]=t[1],e},vec2.fromValues=function(t,e){var i=new Array(2);return i[0]=t,i[1]=e,i},vec2.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},vec2.set=function(t,e,i){return t[0]=e,t[1]=i,t},vec2.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},vec2.sub=vec2.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t},vec2.mul=vec2.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t},vec2.div=vec2.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t},vec2.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t},vec2.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t},vec2.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},vec2.dist=vec2.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)},vec2.sqrDist=vec2.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n},vec2.len=vec2.length=function(t){var e=t[0],i=t[1];return Math.sqrt(e*e+i*i)},vec2.sqrLen=vec2.squaredLength=function(t){var e=t[0],i=t[1];return e*e+i*i},vec2.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},vec2.normalize=function(t,e){var i=e[0],n=e[1],s=i*i+n*n;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s),t},vec2.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},vec2.cross=function(t,e,i){var n=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=n,t},vec2.lerp=function(t,e,i,n){var s=e[0],a=e[1];return t[0]=s+n*(i[0]-s),t[1]=a+n*(i[1]-a),t},vec2.transformMat2=function(t,e,i){var n=e[0],s=e[1];return t[0]=n*i[0]+s*i[1],t[1]=n*i[2]+s*i[3],t},vec2.str=function(t){return"this("+t[0]+", "+t[1]+")"}};vec2();var UserInterface=ClassWFUI.extend({init:function(){this.elements={},this.history=new History,this.maxInactivityTime=3e4,this.lastTouch=(new Date).getTime(),$wfuij(window).resize(WFUICallback(this,this.resize))},start:function(){this.setup(),this.resize()},setup:function(){},onSetupFinished:function(){},setupLanguage:function(){language&&this.wayfinder.languages[language]&&($wfuij("body").removeClass("rtl"),$wfuij("body").removeClass(function(t,e){return(e.match(/(^|\s)language_\S+/g)||[]).join(" ")}),$wfuij("body").addClass("language_"+this.wayfinder.languages[language].getName()),$wfuij("body").addClass(this.wayfinder.languages[language].getTextDirection()))},setIdleTimer:function(){function t(){e.lastTouch=(new Date).getTime(),e.hideScreensaver()}this.wayfinder.settings.data["kiosk.max-inactivity"]&&(this.maxInactivityTime=1e3*parseInt(this.wayfinder.settings.data["kiosk.max-inactivity"],10));var e=this;$wfuij("body").mousedown(t),$wfuij("body").hammer().on("touch",t);var i=function(){var t=(new Date).getTime();t-e.lastTouch>e.maxInactivityTime?(e.lastTouch>-1&&e.onTimeout(),setTimeout(i,e.maxInactivityTime)):setTimeout(i,e.maxInactivityTime-(t-e.lastTouch))};setTimeout(i,this.maxInactivityTime)},resize:function(){},onProgress:function(){},onSetLanguage:function(){this.setupLanguage()},showScreensaver:function(){this.wayfinder.screensaving||$wfuij("#screensaver").show(100)},hideScreensaver:function(){this.wayfinder.screensaving&&($wfuij("#screensaver").hide(100),this.lastTouch=(new Date).getTime())},onTimeout:function(){this.lastTouch=-1,this.showScreensaver()}}),History=ClassWFUI.extend({init:function(){this.setup(),this.states=[]},setup:function(){window.onpopstate=WFUICallback(this,this.back)},write:function(t,e){this.states.push({open:t,close:e}),history&&history.pushState&&history.pushState({id:this.states.length-1},document.title,document.location),t&&"function"==typeof t&&t()},back:function(t){if(this.states.length>0){var e=this.states.pop();e&&e.close&&"function"==typeof e.close&&e.close(),this.states.length>0&&(e=this.states[this.states.length-1],e&&e.open&&"function"==typeof e.open&&e.open())}t.state&&this.onBack(t.state.id),0===this.states.length&&"function"==typeof this.onExit&&this.onExit()},onBack:function(){},onExit:function(){},clear:function(){this.states.length=0},triggerBack:function(){history.back()},callState:function(t){t&&this.states[t]&&"function"==typeof this.states[t]&&this.states[t]()}}),HistoryTree=ClassWFUI.extend({init:function(){this.setup(),this.states={},this.tree={},this.current=[],this.rootState=[]},setup:function(){window.onpopstate=WFUICallback(this,this.back)},setRootState:function(t,e){this.rootState=[t,e]},setTree:function(t){this.tree=t},setState:function(t,e,i){var n=!1;if(null!==this.hasLeaf(t,0))this.current.push(t),n=!0;else if(null!==this.hasLeaf(t,1))this.current.pop(),this.current.push(t),n=!0;else if(null!==this.hasLeaf(t,2))this.current.pop(),this.current.pop(),this.current.push(t),n=!0;else for(var s in this.tree)s==t&&(this.current=[s],n=!0);n&&(this.states[this.current.join(".")]=[e,i],this.callCurrent(),history&&history.pushState&&history.pushState({id:t},document.title,document.location))},hasLeaf:function(t,e){for(var i=this.tree,n=0;n<Math.max(0,this.current.length-e);n++)"object"==typeof i&&(i=i[this.current[n]]);for(var s in i)if(s===t)return i[s];return null},write:function(t,e){this.states.push({open:t,close:e}),history&&history.pushState&&history.pushState({id:this.states.length-1},document.title,document.location),t&&"function"==typeof t&&t()},back:function(){if(0===this.current.length&&"function"==typeof this.onExit)return void this.onExit();var t=this.current.slice(0,Math.max(this.current.length-1)),e=t.join(".");"undefined"!=typeof this.states[e]?("function"==typeof this.states[e][0]&&this.states[e][0](this.states[e][1]),this.current=t,this.onBack(t)):1==this.current.length&&(this.current.pop(),"function"==typeof this.rootState[0]&&this.rootState[0](this.rootState[1]))},onBack:function(){},onExit:function(){},clear:function(){this.current=[]},callCurrent:function(){var t=this.current.join(".");"undefined"!=typeof this.states[t]&&"function"==typeof this.states[t][0]&&this.states[t][0](this.states[t][1])}}),View=ClassWFUI.extend({init:function(t,e){this.position=vec2.create(),this.contentSize=t,this.viewSize=e,this._maxPosition=vec2.create(),this._minPosition=vec2.create()},getViewPosition:function(){return this.position},getContentPosition:function(){return this.position},clampPosition:function(){vec2.sub(this._maxPosition,this.getViewSize(),this.getContentSize()),vec2.max(this._maxPosition,this._minPosition,this._maxPosition),this.position=this.clamp(this.position,vec2.create(),this._maxPosition)},setViewPosition:function(t){!isNaN(parseFloat(t[0]))&&isFinite(t[0])&&!isNaN(parseFloat(t[1]))&&isFinite(t[1])&&(this.position=t,this.clampPosition())},move:function(t){this.setViewPosition(vec2.add(t,this.getViewPosition(),t))},setViewSize:function(t,e){this.viewSize=vec2.fromValues(t,e),this.clampPosition()},setContentSize:function(t,e){this.contentSize=vec2.fromValues(t,e),this.clampPosition()},isContentLonger:function(){return this.viewSize[1]<=this.contentSize[1]},isContentWider:function(){return this.viewSize[0]<=this.contentSize[0]},getContentSize:function(){return this.contentSize},getViewSize:function(){return this.viewSize},clamp:function(t,e,i){var n=vec2.clone(t);return vec2.max(n,n,e),vec2.min(n,n,i),n},getPercentagePosition:function(){return vec2.div(vec2.create(),this.position,this.viewSize)}}),UIComponent=ClassWFUI.extend({init:function(t){this.element=t,this.parent=null},hide:function(t){t?this.element.hide(t):this.element.hide(),this.onHide()},onHide:function(){},show:function(t){t?this.element.show(t):this.element.show(),this.onShow()},onShow:function(){},resize:function(){},activate:function(){this.element.addClass("active"),this.onActivate(this)},onActivate:function(){},deactivate:function(){this.element.removeClass("active"),this.onDeactivate()},onDeactivate:function(){},remove:function(){this.hide(),this.element.empty(),this.element.remove()},update:function(){},addClass:function(t){this.element.addClass(t)},removeClass:function(t){this.element.removeClass(t)},addAttribute:function(t,e){this.element.attr(t,e)}}),Scrollbar=UIComponent.extend({init:function(t,e,i){this.vertical="undefined"!=typeof i?!i:!0,this.position=0,this.containerSize=1,this.contentSize=1,this.onScroll=!1,this.parentElement=t,this.element=$wfuij("<div class='scrollbar "+e+"'></div>"),this.bar=$wfuij("<div class='bar'></div>"),this.element.append(this.bar),t.append(this.element),this._super(this.element),this.element.on("selectstart",!1),this.element.addClass("no-select"),this.mouseDelta=vec2.create(),this.element.hammer().on("drag",WFUICallback(this,this.onDrag)),this.element.hammer().on("dragend",WFUICallback(this,this.onEndDrag)),this.element.hammer().on("dragstart",WFUICallback(this,this.onStartDrag)),this.view=new View(vec2.fromValues(this.bar.width(),this.bar.height()),vec2.fromValues(this.element.innerWidth(),this.element.innerHeight()))},setup:function(t,e){this.contentSize=e,this.containerSize=t;var i=this.containerSize/this.contentSize;this.vertical?(this.element.height(t),this.bar.height(Math.max(5,Math.floor(t*i)))):(this.element.width(t),this.bar.width(Math.max(5,Math.floor(t*i)))),this.resize()},clear:function(){this.position=0,this.setPosition(0)},getBarLength:function(){return parseInt(this.vertical?this.bar.height():this.bar.width())},getViewLength:function(){return this.vertical?this.view.getViewSize()[1]:this.view.getViewSize()[0]},getContentLength:function(){return this.vertical?this.view.getContentSize()[1]:this.view.getContentSize()[0]},setPosition:function(t){Modernizr.csstransforms?this.bar.css(Modernizr.prefixed("transform"),"translate("+t[0]+"px,"+t[1]+"px)"):this.bar.css("left",t[0]+"px").css("top",t[1]+"px")},setContentPosition:function(t){var e=vec2.create(),i=this.containerSize/this.contentSize;vec2.scale(e,t,i),this.view.setViewPosition(e),this.setPosition(this.view.getContentPosition())},onStartDrag:function(t){t&&t.gesture&&(t.gesture.preventDefault(),t.gesture.stopPropagation())},onDrag:function(t){if(t&&t.gesture){t.preventDefault();var e=vec2.fromValues(t.gesture.deltaX,t.gesture.deltaY);this.view.move(vec2.negate(vec2.create(),vec2.sub(vec2.create(),this.mouseDelta,e))),this.mouseDelta=e,this.setPosition(this.view.getContentPosition()),this.onScroll&&"function"==typeof this.onScroll&&this.onScroll(this.getPercentage())}},onTap:function(t){if(t&&t.gesture){t.preventDefault();{vec2.fromValues(t.gesture.deltaX,t.gesture.deltaY)}}},getPercentage:function(){var t=vec2.len(this.view.getViewPosition());return t/this.getViewLength()},onEndDrag:function(){this.mouseDelta=vec2.create()},resize:function(){this.view.setViewSize(parseInt(this.element.width()),parseInt(this.element.height())),this.view.setContentSize(parseInt(this.bar.width()),parseInt(this.bar.height())),this.getViewLength()<=this.getContentLength()||0==this.getViewLength()?this.hide():this.show()}}),DragScroll=ClassWFUI.extend({init:function(t,e,i){this.options={smooth:!0,reverse:!0,swapContainers:!0,updateInterval:10,wheelSpeed:100},void 0!==i&&i&&(this.options=this.chooseOptions(this.options,i)),this.viewElement=t,this.contentElement=e,this.viewElement.addClass("scrollable-view"),this.contentElement.addClass("scrollable-content"),this.mouseDelta=vec2.create(),this.smoothDistance=null,this.timeout=null,this.updateCallback=!1,this.transformsSupported=this.isTransformSupported(),this.smoothCoeficent=vec2.fromValues(11,11),this._vec2cache=vec2.create(),this.positionClassNames="",this.view=this.getOption("swapContainers")?new View(vec2.fromValues(this.viewElement.width(),this.viewElement.height()),vec2.fromValues(this.contentElement.width(),this.contentElement.height())):new View(vec2.fromValues(this.contentElement.width(),this.contentElement.height()),vec2.fromValues(this.viewElement.width(),this.viewElement.height()));var n=this;$wfuij(window).resize(function(){n.resize()});var s=new Hammer(this.viewElement[0]);s.on("dragstart",function(t){t&&t.gesture&&t.preventDefault(),n.onStartDrag(),n.stop()}),s.on("tap",function(t){t.preventDefault()}),s.on("drag",WFUICallback(this,this.onDrag)),s.on("dragend",WFUICallback(this,this.onEndDrag)),this.viewElement.bind("mousewheel",function(t,e){n.scroll(vec2.fromValues(0,-n.getOption("wheelSpeed")*e))})},chooseOptions:function(t,e){for(var i in e)t[i]&&(t[i]=e[i]);return t},getOption:function(t){return this.options[t]},setOption:function(t,e){this.options[t]=e},setSmoothScrolling:function(t){this.setOption("smooth",t)},setDirection:function(t){this.setOption("reverse",t)},onStartDrag:function(){},onDrag:function(t){if(t&&t.gesture&&-1==t.gesture.target.className.search("bar")&&(t.preventDefault(),!this.scrolling)){this.scrolling=!0;var e=vec2.fromValues(t.gesture.deltaX,t.gesture.deltaY);this.scroll(this.getOption("reverse")?vec2.subtract(vec2.create(),this.mouseDelta,e):vec2.subtract(vec2.create(),e,this.mouseDelta)),this.mouseDelta=e}},scroll:function(t){var e=this;this.timeout=requestAnimFrame(function(){e.view.move(t),t=vec2.clone(e.view.getContentPosition()),e.setContentOffset(t),e.updateCallback&&"function"==typeof e.updateCallback&&e.updateCallback(e)},0)},reset:function(){this.setScroll(vec2.create())},setScroll:function(t){this.view.setViewPosition(t),this.setContentOffset(this.view.getContentPosition())},resize:function(){this.getOption("swapContainers")?(this.view.setViewSize(parseInt(this.contentElement.innerWidth()),parseInt(this.contentElement.innerHeight())),this.view.setContentSize(parseInt(this.viewElement.width()),parseInt(this.viewElement.height()))):(this.view.setViewSize(parseInt(this.viewElement.innerWidth()),parseInt(this.viewElement.innerHeight())),this.view.setContentSize(parseInt(this.contentElement.width()),parseInt(this.contentElement.height()))),this.scroll(0),this.checkIfScrollIsNeeded()},setContentOffset:function(t){var e=1;this.getOption("swapContainers")&&(e=-1),this.transformsSupported?this.contentElement.css(this.transformsSupported+"transform","translate("+t[0]*e+"px,"+t[1]*e+"px)"):this.contentElement.css("left",t[0]*e+"px").css("top",t[1]*e+"px"),this.scrolling=!1,this.checkContentPosition()},stop:function(){this.mouseDelta=vec2.create(),this.timeout&&cancelAnimationFrame(this.timeout)},onEndDrag:function(t){if(void 0!==t&&"dragend"===t.type&&t.gesture){t.gesture.preventDefault();var e=vec2.fromValues(t.gesture.velocityX,t.gesture.velocityY);if(this.getOption("smooth")&&vec2.sqrLen(e)>.3){var i=vec2.fromValues(t.gesture.deltaX,t.gesture.deltaY),n=vec2.create();vec2.multiply(n,i,e);var s=this;this.stop();var a=function(){var t=vec2.create();vec2.div(t,n,s.smoothCoeficent),vec2.sqrLen(t)>3&&(vec2.sub(n,n,t),requestAnimFrame(a,s.getOption("updateInterval")),vec2.negate(t,t),s.scroll(t))};this.timeout=requestAnimFrame(a,s.updateInterval)}}},setUpdateCallback:function(t){this.updateCallback=t},setRelativePosition:function(t){var e=vec2.create();vec2.scale(e,vec2.sub(e,this.view.getViewSize(),this.view.getContentSize()),t),this.setScroll(e)},getRelativePosition:function(){return vec2.div(this._vec2cache,this.view.getViewPosition(),vec2.sub(this._vec2cache,this.view.getViewSize(),this.view.getContentSize())),this._vec2cache},checkIfScrollIsNeeded:function(){this.view.isContentLonger()&&this.viewElement.addClass("content-longer"),this.view.isContentWider()&&this.viewElement.addClass("content-wider")},checkContentPosition:function(){var t=this.getRelativePosition(),e=[];0===t[0]&&e.push("on-left"),0===t[1]&&e.push("on-top"),1===t[0]&&e.push("on-right"),1===t[1]&&e.push("on-bottom"),e=e.join(" "),e!==this.positionClassNames&&(this.viewElement.removeClass(this.positionClassNames),this.viewElement.addClass(e),this.positionClassNames=e)},isTransformSupported:function(){for(var t=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],e=["","-webkit-","-moz-","-o-","-ms-"],i=0;i<t.length;i++)if(void 0!==document.createElement("div").style[t[i]])return e[i];return!1}});window.requestAnimFrame=function(t,e){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,e)}}(),function(){window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}();var ScrollableComponent=UIComponent.extend({init:function(t){this.viewElement=t,this.viewElement.addClass("scrollable-view"),this.scrollbar=!1,this.contentElement=this.viewElement.find(".scrollable-content"),this.contentElement[0]||(this.contentElement=$wfuij("<div class='scrollable-content no-select'></div>"),this.viewElement.append(this.contentElement)),this._super(this.contentElement),this.dragScroll=new DragScroll(this.viewElement,this.contentElement)},addScrollbar:function(){this.scrollbar=new Scrollbar(this.viewElement,"right"),this.scrollbar.setup(parseInt(this.viewElement.height()),parseInt(this.contentElement.height())),this.viewElement.addClass("hasScrollbar"),this.dragScroll.setUpdateCallback(WFUICallback(this,this.updateScrollbar)),this.scrollbar.onScroll=WFUICallback(this,this.updateScrollContainer)},updateScrollbar:function(t){this.scrollbar.setContentPosition(t.view.getContentPosition())},updateScrollContainer:function(t){this.dragScroll.setScroll(vec2.scale(vec2.create(),this.dragScroll.view.viewSize,t))},show:function(){this.viewElement.show(),this.onShow()},hide:function(){this.viewElement.hide(),this.onHide()},resize:function(){this.dragScroll.resize(),this.scrollbar&&(this.scrollbar.setup(parseInt(this.viewElement.height()),parseInt(this.contentElement.height())),this.scrollbar.resize(),parseInt(this.viewElement.height())<parseInt(this.contentElement.height())?(this.viewElement.addClass("hasScrollbar"),this.scrollbar.show()):(this.viewElement.removeClass("hasScrollbar"),this.scrollbar.hide()))},reset:function(){this.dragScroll.resize(),this.dragScroll.reset()},activate:function(){this._super(),this.resize()},update:function(){this.resize()}}),UserMessage=ClassWFUI.extend({init:function(t,e,i,n){this.wayfinder=i,this.type=e,this.key=t,this.callback=n,this.timeout=15e3,this.draw()},draw:function(){this.element=$wfuij("<div class='message "+this.type+"'></div>");this.wayfinder.translator.getLanguage();this.wayfinder.translator.translateElement(this.element,this.key),this.element.hammer().on("tap",WFUICallback(this,this.onClick)),setTimeout(WFUICallback(this,this.close),this.timeout),this.wayfinder.options.messages.append(this.element)},close:function(){var t=this.element;t&&(this.element.hide(200,function(){t.remove()}),delete this.element)},onClick:function(){this.close(),this.callback&&this.callback(this)}}),Button=UIComponent.extend({init:function(t,e,i){this._super(t),this.title=e,this.callback=i,this.setTitle(e);var n=new Hammer(this.element[0]);n&&n.on("tap",WFUICallback(this,this.onClick))},setTitle:function(t){this.title=t,this.element.text(t)},onClick:function(t){this.callback&&"function"==typeof this.callback&&this.callback(t)}}),LoadingScreen=UIComponent.extend({init:function(t){this._super(t),this.element=t,this.tabs=!1,this.progress=0},setProgress:function(t){this.progress=Math.max(Math.min(parseInt(100*t),100),0),this.element&&this.element.find(".progress").one().css("width",this.progress+"%")},onLoadingDone:function(){this.hide()}}),Menu=UIComponent.extend({init:function(t){t?(this.element=t,this.element.addClass("no-select"),this.items=[],this.cache=[],this.active=!1):console.error("Menu: No element given!")},add:function(t){return this.items.push(t),t.onAdd(this),this.addItemElement(t),this.addCallback(t),t},prepend:function(t){return this.items.push(t),t.onAdd(this),this.prependItemElement(t),this.addCallback(t),t},addItemElement:function(t){this.cache.push(t.element)},prependItemElement:function(t){this.cache.unshift(t.element)},publish:function(){this.element.empty().append(this.cache),this.cache=[]},addCallback:function(t){var e=this,i=new Hammer(t.element[0]);t.element&&i&&(i.on("tap",function(i){i.preventDefault(),e.activateItem(t),t.callback&&"function"==typeof t.callback&&t.callback(t),e.onItemClick(t,i),t.onClick()}),i.on("touchstart",function(){t.element.addClass("tapped")}),i.on("touchend",function(){t.element.removeClass("tapped")}))},activateItem:function(t){this.deactivateAll(t),this.active=t,this.active&&this.active.activate(this)},deactivateAll:function(t){this.active&&this.active!==t&&(this.active.deactivate(this),this.active=!1)},activateItemWithObject:function(t){for(var e in this.items)if(this.items[e].dataObject==t)return void this.activateItem(this.items[e])},triggerItemWithObject:function(t){for(var e in this.items)if(this.items[e].dataObject==t)return this.activateItem(this.items[e]),void this.onItemClick(this.items[e])},onItemClick:function(){},clear:function(){this.active=!1;for(var t in this.items)this.items[t].remove(this);this.items.length=0,this.element.empty()},onSetLanguage:function(){this.resize()},sort:function(t){this.items.sort(function(e,i){return e.less(i,t)?-1:i.less(e,t)?1:0}),this.element.empty();for(var e in this.items)this.addItemElement(this.items[e]),this.addCallback(this.items[e])}}),ScrollableMenu=Menu.extend({init:function(t){this.viewElement=t,this.viewElement.addClass("scrollable-view"),this.scrollbar=!1,this.contentElement=this.viewElement.find(".scrollable-content"),this.contentElement[0]||(this.contentElement=$wfuij("<div class='scrollable-content'></div>"),this.viewElement.append(this.contentElement)),this._super(this.contentElement),this.dragScroll=new DragScroll(this.viewElement,this.contentElement)},addScrollbar:function(){this.scrollbar=new Scrollbar(this.viewElement,"right"),this.scrollbar.setup(parseInt(this.viewElement.height()),parseInt(this.contentElement.height())),this.viewElement.addClass("hasScrollbar"),this.dragScroll.setUpdateCallback(WFUICallback(this,this.updateScrollbar)),this.scrollbar.onScroll=WFUICallback(this,this.updateScrollContainer)},updateScrollbar:function(t){this.scrollbar.setContentPosition(t.view.getContentPosition())},updateScrollContainer:function(t){this.dragScroll.setScroll(vec2.scale(vec2.create(),this.dragScroll.view.viewSize,t))},show:function(){this.viewElement.show(),this.onShow()},hide:function(){this.viewElement.hide(),this.onHide()},resize:function(){this.dragScroll.resize(),this.scrollbar&&(this.scrollbar.setup(parseInt(this.viewElement.height()),parseInt(this.contentElement.height())),this.scrollbar.resize(),parseInt(this.viewElement.height())<parseInt(this.contentElement.height())?(this.viewElement.addClass("hasScrollbar"),this.scrollbar.show()):(this.viewElement.removeClass("hasScrollbar"),this.scrollbar.hide()))},reset:function(){this.dragScroll.resize(),this.dragScroll.reset()},activate:function(){this._super(),this.resize()},update:function(){this.resize()},publish:function(){this._super(),this.reset()}}),MenuItem=UIComponent.extend({init:function(t){this.label=t,this.callback=!1,this.dataObject=!1,this.element=!1,this.createElement()},setCallback:function(t){t&&"function"==typeof t&&(this.callback=t)},getCallback:function(){return this.callback},getDataObject:function(){return this.dataObject},setDataObject:function(t){this.dataObject=t},createElement:function(){var t=document.createElement("div");t.className="item",t.innerHTML=this.label,this.element=$wfuij(t),this.element.on("touchmove",function(t){t.preventDefault()}),this.element.on("selectstart",!1)},getLabel:function(){return this.label},onClick:function(){},onAdd:function(){},less:function(t){return this.element.text()<t.element.text()}}),BulletItem=MenuItem.extend({init:function(t){this._super(t)},createElement:function(){this.element=$wfuij("<div class='item bullet "+this.label+"'>"+this.label+"</div>"),this.bullet=$wfuij("<div class='bullet'></div>"),this.element.prepend(this.bullet),this.element.bind("touchmove",function(t){t.preventDefault()})},setBulletColor:function(t){this.bullet&&this.bullet.css("background-color",t.toString())}}),ValueMenuItem=MenuItem.extend({init:function(t,e){this.value=e,this.valueElement=null,this.nameElement=null,this._super(t)},createElement:function(){var t=document.createElement("div");t.className="item "+this.label,this.element=$wfuij(t);var e=document.createElement("div");e.setAttribute("name","name"),e.innerHTML=this.label,this.nameElement=$wfuij(e);var i=document.createElement("div");i.setAttribute("name","value"),i.innerHTML=this.value,this.valueElement=$wfuij(i),this.element.append([this.nameElement,this.valueElement]),this.element.bind("touchmove",function(t){t.preventDefault()})},getNameElement:function(){return this.nameElement},getValueElement:function(){return this.valueElement}}),TextInputItem=MenuItem.extend({init:function(t,e){this.input=!1,this.valueChangeCallback=e,this.lastKeyPress=-1,this.isDefaultValue=!0,this.timeout=null,this.wait=500,this._super(t),this.setValue(t)},createElement:function(){this.element=$wfuij("<div class='item searchitem'></div>"),this.input=$wfuij("<input type='text' data-label='"+this.label+"'/>"),this.element.append(this.input)},onAdd:function(){this.input.keyup(WFUICallback(this,this.onChange))},onClick:function(){this.input.val()==this.input.attr("data-label")&&this.input.val(""),this.lastKeyPress=-1},getValue:function(){return this.input.val()},setValue:function(t){this.input.val(t)},checkLastKeyPress:function(){var t=(new Date).getTime();this.isDefaultValue=!1,this.lastKeyPress&&this.lastKeyPress-t>-this.wait?(clearTimeout(this.timeout),this.timeout=setTimeout(WFUICallback(this,this.checkLastKeyPress),this.wait)):this.lastKeyPress>0&&(this.lastKeyPress=-1,clearTimeout(this.timeout),this.callValueChange())},onChange:function(){var t=(new Date).getTime();clearTimeout(this.timeout),this.timeout=setTimeout(WFUICallback(this,this.checkLastKeyPress),this.wait),this.lastKeyPress=t},callValueChange:function(){this.valueChangeCallback&&"function"==typeof this.valueChangeCallback&&this.getValue()!=this.input.attr("data-label")&&this.valueChangeCallback(this.getValue())},onDeactivate:function(){""===this.input.val()&&this.reset()},update:function(){""===this.input.val()&&this.input.val(this.input.attr("data-label"))},reset:function(){this.input.val(this.input.attr("data-label")),this.isDefaultValue=!0,this.input.blur()}}),ImageMenuItem=MenuItem.extend({init:function(t){this.imageId=!1,this.iconElement=!1,this.textElement=!1,this._super(t)},getInnerElement:function(){return this.innerElement},setBackground:function(t){this.iconElement.css("background-image","url('"+t+"')")},createElement:function(){this.element=$wfuij("<div class='item imageitem'></div>"),this.iconElement=$wfuij("<div class='icon'></div>"),this.textElement=$wfuij("<div class='label'>"+this.label+"</div>"),this.element.append(this.iconElement),this.element.append(this.textElement),this.element.bind("touchmove",function(t){t.preventDefault()})}}),MultiValueMenuItem=MenuItem.extend({init:function(){this.values=[],this.elements=[];for(var t in arguments)"string"==typeof arguments[t]&&this.values.push(arguments[t]);var e="";this.values[0]&&(e=this.values[0]),this._super(e)},createElement:function(){var t=document.createElement("div");t.className="item multivalueitem",this.element=$wfuij(t);var e=null;for(var i in this.values)e=document.createElement("div"),e.className="val-"+i,e.innerHTML=this.values[i],this.element.append($wfuij(e)),this.elements.push(e);this.element.bind("touchmove",function(t){t.preventDefault()})},getElement:function(){return this.nameElement}}),StaticMenuItem=MenuItem.extend({init:function(t,e){this._super(e),this.element=t,this.createElement()},createElement:function(){this.element.bind("touchmove",function(t){t.preventDefault()})},update:function(){}}),SubMenuItem=MenuItem.extend({init:function(t,e){this.menu=e,this.menuElement=!1,this.nameElement=!1,this._super(t)},addMenu:function(t){this.menu=t,this.menu&&this.menu.hide()},createElement:function(){var t=document.createElement("div");t.className="submenuitem item",this.element=$wfuij(t);var e=document.createElement("div");e.className="label",e.innerHTML=this.label,this.nameElement=$wfuij(e);var i=document.createElement("div");i.className="submenu menu",this.menuElement=$wfuij(i),this.element.append([this.nameElement,this.menuElement]),this.element.bind("touchmove",function(t){t.preventDefault()})},onActivate:function(){this.menu&&this.menu.show()},onDeactivate:function(){this.menu&&this.menu.hide()}}),Tab=ClassWFUI.extend({init:function(t,e,i){this.name=t,e&&e instanceof UIComponent&&(this.panel=e),i&&i instanceof UIComponent&&(this.button=i)},update:function(){this.panel.update(),this.button&&this.button.update()},getPanel:function(){return this.panel},getButton:function(){return this.button},remove:function(){},show:function(){this.panel.show(),this.button&&this.button.activate()},hide:function(){this.panel.hide(),this.button&&this.button.deactivate()},activate:function(){this.panel&&this.panel.activate(),this.button&&this.button.activate()},deactivate:function(){this.panel&&this.panel.deactivate(),this.button&&this.button.deactivate()},restore:function(){this.panel&&this.panel.show(this)},resize:function(){this.panel&&this.panel.resize(),this.button&&this.button.resize()}}),Tabs=Menu.extend({init:function(t){this._super(t),this.tabs=[],this.activeTab=!1},add:function(t,e,i){return this.tabs[t]=new Tab(t,e,i),i&&this._super(i),this.tabs[t]},removeTab:function(t){for(var e in this.tabs)if(this.tabs[e]==t)return this.tabs.splice(e,1),void this.tabs[e].remove(this)},getTab:function(t){return this.tabs[t]},activate:function(t){if(t instanceof UIComponent)for(var e in this.tabs)this.tabs[e]==t&&this.activateTab(e)},activateTab:function(t){var e=this.getTab(t);e&&(this.activeTab&&this.activeTab!==e&&(this.activeTab.hide(this),this.activeTab.deactivate()),this.activeTab=e,this.activeTab.show(this),this.activeTab.activate(),this.onActivate(this.activeTab,t))},restoreTab:function(t){var e=this.getTab(t);e&&(this.activeTab&&this.activeTab!==e&&(this.activeTab.hide(this),this.activeTab.deactivate()),this.activeTab=e,this.activeTab.show(this),this.activeTab.activate())},resize:function(){this._super();for(var t in this.tabs)this.tabs[t].resize()},update:function(){for(var t in this.tabs)this.tabs[t].update()}});